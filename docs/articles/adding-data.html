<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Adding Data to SPATA2 objects • SPATA2</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Adding Data to SPATA2 objects">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPATA2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li>
  <a href="../articles/spata-data.html">SPATAData</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Initiating a SPATA2 object</li>
    <li>
      <a href="../articles/initiation-and-preprocessing-customized.html">Initiation &amp; Preprocessing with individual data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-merfish.html">Initiation &amp; Preprocessing with MERFISH data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium.html">Initiation &amp; Preprocessing with Visium data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium-hd.html">Initiation &amp; Preprocessing with VisiumHD data</a>
    </li>
    <li class="dropdown-header">Basic Manipulation of a SPATA2 object</li>
    <li>
      <a href="../articles/adding-data.html">Adding Data to SPATA2 objects</a>
    </li>
    <li>
      <a href="../articles/package-compatibility.html">Platform Compatibility</a>
    </li>
    <li>
      <a href="../articles/molecular-variables.html">Molecular Variables</a>
    </li>
    <li>
      <a href="../articles/image-handling.html">Image Handling</a>
    </li>
    <li>
      <a href="../articles/spatial-segmentation.html">Spatial Segmentation</a>
    </li>
    <li class="dropdown-header">Implemented Algorithms &amp; Concepts</li>
    <li>
      <a href="../articles/cnv.html">Copy Number Variations</a>
    </li>
    <li>
      <a href="../articles/clustering.html">Clustering</a>
    </li>
    <li>
      <a href="../articles/dimensional-reduction.html">Dimensional Reduction</a>
    </li>
    <li>
      <a href="../articles/dea.html">Differential Expression</a>
    </li>
    <li>
      <a href="../articles/gsea.html">Gene Set Enrichment</a>
    </li>
    <li>
      <a href="../articles/spatial-measures.html">Spatial Measures</a>
    </li>
    <li class="dropdown-header">Spatial Gradient Screening</li>
    <li>
      <a href="../articles/creating-spatial-annotations.html">Creating Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/using-spatial-annotations.html">Using Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/spatial-annotation-screening.html">Spatial Annotation Screening</a>
    </li>
    <li>
      <a href="../articles/creating-spatial-trajectories.html">Creating Spatial Trajectories</a>
    </li>
    <li>
      <a href="../articles/spatial-trajectory-screening.html">Spatial Trajectory Screening</a>
    </li>
    <li class="dropdown-header">Visualization</li>
    <li>
      <a href="../articles/plotting-surface.html">Surface Plotting</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/newslog.html">Newslog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Adding Data to SPATA2 objects</h1>
            
      

      <div class="hidden name"><code>adding-data.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">1. Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>While SPATA2 provides wrappers for multiple algorithms, you can
always add data from external sources and packages. Depending on the
kind of data you want to add, different functions are required.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://themilolab.com/" class="external-link">SPATA2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load SPATA2 inbuilt example data</span></span>
<span><span class="va">object_t269</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loadExampleObject.html">loadExampleObject</a></span><span class="op">(</span><span class="st">"UKF269T"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="data-matrices">2. Data matrices<a class="anchor" aria-label="anchor" href="#data-matrices"></a>
</h2>
<p>Assuming you have a data matrix processed with functions from a
different package (e.g. Seurat), you can add them to the SPATA2 object
via the function <code><a href="../reference/addProcessedMatrix.html">addProcessedMatrix()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create Seurat object from count matrix</span></span>
<span><span class="va">count_mtr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getCountMatrix.html">getCountMatrix</a></span><span class="op">(</span><span class="va">object_t269</span><span class="op">)</span></span>
<span></span>
<span><span class="va">seurat_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/CreateSeuratObject.html" class="external-link">CreateSeuratObject</a></span><span class="op">(</span><span class="va">count_mtr</span><span class="op">)</span></span>
<span><span class="va">seurat_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/NormalizeData.html" class="external-link">NormalizeData</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">)</span></span>
<span><span class="va">seurat_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/ScaleData.html" class="external-link">ScaleData</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scaled_mtr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/AssayData.html" class="external-link">GetAssayData</a></span><span class="op">(</span><span class="va">seurat_obj</span>, layer <span class="op">=</span> <span class="st">"scale.data"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show a small subset of the scaled mtr </span></span>
<span><span class="va">scaled_mtr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##            AAACAAGTATCTCCCA-1 AAACACCAATAACTGC-1 AAACAGAGCGACTCCT-1</span></span>
<span><span class="co">## AL669831.5        -0.13779796        -0.13779796        -0.13779796</span></span>
<span><span class="co">## FAM87B            -0.03675644        -0.03675644        -0.03675644</span></span>
<span><span class="co">## FAM41C            -0.11923196        -0.11923196        -0.11923196</span></span>
<span><span class="co">## AL645608.1        -0.02790417        -0.02790417        -0.02790417</span></span>
<span><span class="co">## KLHL17            -0.20169999         4.33113446        -0.20169999</span></span>
<span><span class="co">##            AAACATTTCCCGGATT-1 AAACCCGAACGAAATC-1</span></span>
<span><span class="co">## AL669831.5        -0.13779796        -0.13779796</span></span>
<span><span class="co">## FAM87B            -0.03675644        -0.03675644</span></span>
<span><span class="co">## FAM41C            -0.11923196        -0.11923196</span></span>
<span><span class="co">## AL645608.1        -0.02790417        -0.02790417</span></span>
<span><span class="co">## KLHL17            -0.20169999        -0.20169999</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add the processed matrix to SPATA2 object under the name 'scaled'</span></span>
<span><span class="va">object_t269</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/addProcessedMatrix.html">addProcessedMatrix</a></span><span class="op">(</span></span>
<span>    object <span class="op">=</span> <span class="va">object_t269</span>,</span>
<span>    proc_mtr <span class="op">=</span> <span class="va">scaled_mtr</span>,</span>
<span>    mtr_name <span class="op">=</span> <span class="st">"scaled"</span>  </span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># the matrix is now accessible next to all other matrices</span></span>
<span><span class="co"># ('counts' refers to the raw count matrix with which the SPATA2 object has been initated)</span></span>
<span><span class="fu"><a href="../reference/getMatrixNames.html">getMatrixNames</a></span><span class="op">(</span><span class="va">object_t269</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "counts" "scaled"</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check which matrix is currently active</span></span>
<span><span class="fu"><a href="../reference/activateMatrix.html">activeMatrix</a></span><span class="op">(</span><span class="va">object_t269</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "counts"</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a surface plot with EGFR expression using raw counts </span></span>
<span><span class="va">egfr_counts</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">object_t269</span>, color_by <span class="op">=</span> <span class="st">"EGFR"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle <span class="op">=</span> <span class="st">"Matrix: raw counts"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># activate the processes matrix to make functions pick it by default</span></span>
<span><span class="va">object_t269</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/activateMatrix.html">activateMatrix</a></span><span class="op">(</span><span class="va">object_t269</span>, mtr_name <span class="op">=</span> <span class="st">"scaled"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/activateMatrix.html">activeMatrix</a></span><span class="op">(</span><span class="va">object_t269</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "scaled"</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create a surface plot with EGFR expression using scaled expression</span></span>
<span><span class="va">egfr_scaled</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">object_t269</span>, color_by <span class="op">=</span> <span class="st">"EGFR"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle <span class="op">=</span> <span class="st">"Matrix: scaled by seurat"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show plots</span></span>
<span><span class="va">egfr_counts</span></span>
<span><span class="va">egfr_scaled</span></span></code></pre></div>
<p><img src="adding-data_files/figure-html/unnamed-chunk-2-1.png" width="50%"><img src="adding-data_files/figure-html/unnamed-chunk-2-2.png" width="50%"></p>
</div>
<div class="section level2">
<h2 id="meta-features">3. Meta features<a class="anchor" aria-label="anchor" href="#meta-features"></a>
</h2>
<p>Features that are not raw or processed molecular counts, like
clustering or certain scores, are stored in the meta data.frame of the
<code>SPATA2</code> object, as obtained by <code><a href="../reference/getMetaDf.html">getMetaDf()</a></code>.
SPATA2 intern functions like <code><a href="../reference/runBayesSpaceClustering.html">runBayesSpaceClustering()</a></code> or
<code><a href="../reference/runCNV.html">runCNV()</a></code> add the results automatically to this data.frame.
The following code chunk creates a data.frame of meta SPATA2 extern
created meta features that can be added to the <code>SPATA2</code>
object.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seurat_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html" class="external-link">FindVariableFeatures</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">)</span></span>
<span><span class="va">seurat_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/RunPCA.html" class="external-link">RunPCA</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">)</span></span>
<span><span class="va">seurat_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindNeighbors.html" class="external-link">FindNeighbors</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">)</span></span>
<span><span class="va">seurat_obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindClusters.html" class="external-link">FindClusters</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of nodes: 3217</span></span>
<span><span class="co">## Number of edges: 108933</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Running Louvain algorithm...</span></span>
<span><span class="co">## Maximum modularity in 10 random starts: 0.8293</span></span>
<span><span class="co">## Number of communities: 11</span></span>
<span><span class="co">## Elapsed time: 0 seconds</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add rownames as 'barcodes' variable </span></span>
<span><span class="va">seurat_meta_df</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span><span class="va">seurat_obj</span><span class="op">@</span><span class="va">meta.data</span>, var <span class="op">=</span> <span class="st">"barcodes"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show meta df</span></span>
<span><span class="va">seurat_meta_df</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3,217 × 6</span></span></span>
<span><span class="co">##    barcodes   orig.ident nCount_RNA nFeature_RNA RNA_snn_res.0.8 seurat_clusters</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> AAACAAGTA… SeuratPro…       <span style="text-decoration: underline;">1</span>614          842 0               0              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> AAACACCAA… SeuratPro…      <span style="text-decoration: underline;">10</span>498         <span style="text-decoration: underline;">3</span>211 10              10             </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> AAACAGAGC… SeuratPro…       <span style="text-decoration: underline;">1</span>258          739 1               1              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> AAACATTTC… SeuratPro…       <span style="text-decoration: underline;">2</span>387         <span style="text-decoration: underline;">1</span>226 0               0              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> AAACCCGAA… SeuratPro…       <span style="text-decoration: underline;">3</span>070         <span style="text-decoration: underline;">1</span>373 0               0              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> AAACCGGGT… SeuratPro…      <span style="text-decoration: underline;">14</span>562         <span style="text-decoration: underline;">3</span>579 5               5              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> AAACCGTTC… SeuratPro…       <span style="text-decoration: underline;">8</span>014         <span style="text-decoration: underline;">2</span>610 3               3              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> AAACCTAAG… SeuratPro…       <span style="text-decoration: underline;">4</span>476         <span style="text-decoration: underline;">1</span>945 9               9              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> AAACCTCAT… SeuratPro…       <span style="text-decoration: underline;">9</span>823         <span style="text-decoration: underline;">2</span>818 5               5              </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> AAACGAGAC… SeuratPro…        584          415 1               1              </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 3,207 more rows</span></span></span></code></pre>
<p>The meta data.frame from the <code>Seurat</code> object contains
cluster results as well as summarizing numeric variables like
<em>nCount_RNA</em> and <em>nFeature_RNA</em>. These variables can be
added to the <code>SPATA2</code> object and are afterwards accessible
with all SPATA2 functions.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add features from the data.frame </span></span>
<span><span class="va">object_t269</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/addFeatures.html">addFeatures</a></span><span class="op">(</span></span>
<span>    object <span class="op">=</span> <span class="va">object_t269</span>,</span>
<span>    feature_df <span class="op">=</span> <span class="va">seurat_meta_df</span>, </span>
<span>    feature_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nCount_RNA"</span>, <span class="st">"seurat_clusters"</span><span class="op">)</span>, </span>
<span>    overwrite <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># once added, they are accessible for all SPATA2 functions </span></span>
<span><span class="fu"><a href="../reference/plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">object_t269</span>, color_by <span class="op">=</span> <span class="st">"nCount_RNA"</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="../reference/plotSurface.html">plotSurface</a></span><span class="op">(</span><span class="va">object_t269</span>, color_by <span class="op">=</span> <span class="st">"seurat_clusters"</span>, pt_clrp <span class="op">=</span> <span class="st">"sifre"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="adding-data_files/figure-html/unnamed-chunk-4-1.png" width="50%"><img src="adding-data_files/figure-html/unnamed-chunk-4-2.png" width="50%"></p>
<p>Grouping variables such as the <em>seurat_clusters</em> variable can
be used for comparative analysis.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotBoxplot.html">plotBoxplot</a></span><span class="op">(</span><span class="va">object_t269</span>, variables <span class="op">=</span> <span class="st">"nCount_RNA"</span>, across <span class="op">=</span> <span class="st">"seurat_clusters"</span>, clrp <span class="op">=</span> <span class="st">"sifre"</span><span class="op">)</span> <span class="op">+</span> </span>
<span> <span class="fu"><a href="../reference/legendBottom.html">legendNone</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"seurat clusters"</span><span class="op">)</span></span></code></pre></div>
<p><img src="adding-data_files/figure-html/unnamed-chunk-5-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="images">4. Images<a class="anchor" aria-label="anchor" href="#images"></a>
</h2>
<p>To learn how to register additional images in the <code>SPATA2</code>
object please refer to the vignette about <a href="articles/image-handling.html">image handling</a> in SPATA2.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jan Kueckelhaus, Dieter-Henrik Heiland.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
