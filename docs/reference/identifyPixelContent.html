<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Identify pixel content — identifyPixelContent • SPATA2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Identify pixel content — identifyPixelContent"><meta property="og:description" content="Determines the type of content displayed by each pixel in the image,
categorizing it as tissue from tissue segments or fragments, artifacts, or background."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPATA2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li>
  <a href="../articles/spata-data.html">SPATAData</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Initiating a SPATA2 object</li>
    <li>
      <a href="../articles/initiation-and-preprocessing-customized.html">Initiation &amp; Preprocessing with individual data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-merfish.html">Initiation &amp; Preprocessing with MERFISH data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium.html">Initiation &amp; Preprocessing with Visium data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium-hd.html">Initiation &amp; Preprocessing with VisiumHD data</a>
    </li>
    <li class="dropdown-header">Basic Manipulation of a SPATA2 object</li>
    <li>
      <a href="../articles/adding-data.html">Adding Data to SPATA2 objects</a>
    </li>
    <li>
      <a href="../articles/package-compatibility.html">Platform Compatibility</a>
    </li>
    <li>
      <a href="../articles/molecular-variables.html">Molecular Variables</a>
    </li>
    <li>
      <a href="../articles/image-handling.html">Image Handling</a>
    </li>
    <li>
      <a href="../articles/spatial-segmentation.html">Spatial Segmentation</a>
    </li>
    <li class="dropdown-header">Implemented Algorithms &amp; Concepts</li>
    <li>
      <a href="../articles/cnv.html">Copy Number Variations</a>
    </li>
    <li>
      <a href="../articles/clustering.html">Clustering</a>
    </li>
    <li>
      <a href="../articles/dimensional-reduction.html">Dimensional Reduction</a>
    </li>
    <li>
      <a href="../articles/dea.html">Differential Expression</a>
    </li>
    <li>
      <a href="../articles/gsea.html">Gene Set Enrichment</a>
    </li>
    <li>
      <a href="../articles/spatial-measures.html">Spatial Measures</a>
    </li>
    <li class="dropdown-header">Spatial Gradient Screening</li>
    <li>
      <a href="../articles/creating-spatial-annotations.html">Creating Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/using-spatial-annotations.html">Using Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/spatial-annotation-screening.html">Spatial Annotation Screening</a>
    </li>
    <li>
      <a href="../articles/creating-spatial-trajectories.html">Creating Spatial Trajectories</a>
    </li>
    <li>
      <a href="../articles/spatial-trajectory-screening.html">Spatial Trajectory Screening</a>
    </li>
    <li class="dropdown-header">Visualization</li>
    <li>
      <a href="../articles/plotting-surface.html">Surface Plotting</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/newslog.html">Newslog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identify pixel content</h1>

    <div class="hidden name"><code>identifyPixelContent.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Determines the type of content displayed by each pixel in the image,
categorizing it as tissue from tissue segments or fragments, artifacts, or background.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">identifyPixelContent</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'SPATA2'</span></span>
<span><span class="fu">identifyPixelContent</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"otsu"</span>,</span>
<span>  img_name <span class="op">=</span> <span class="fu"><a href="activateImage.html">activeImage</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  percentile <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  compactness_factor <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  superpixel <span class="op">=</span> <span class="fl">600</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1.414</span> <span class="op">*</span> <span class="fl">2</span>,</span>
<span>  minPts <span class="op">=</span> <span class="fl">0.005</span>,</span>
<span>  frgmt_threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'SpatialData'</span></span>
<span><span class="fu">identifyPixelContent</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"otsu"</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  img_name <span class="op">=</span> <span class="fu"><a href="activateImage.html">activeImage</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span>,</span>
<span>  percentile <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  compactness_factor <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  superpixel <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1.414</span> <span class="op">*</span> <span class="fl">2214</span>,</span>
<span>  minPts <span class="op">=</span> <span class="fl">0.005</span>,</span>
<span>  frgmt_threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'HistoImage'</span></span>
<span><span class="fu">identifyPixelContent</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"otsu"</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  percentile <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  compactness_factor <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  superpixel <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1.414</span> <span class="op">*</span> <span class="fl">2214</span>,</span>
<span>  minPts <span class="op">=</span> <span class="fl">0.005</span>,</span>
<span>  frgmt_threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'Image'</span></span>
<span><span class="fu">identifyPixelContent</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"otsu"</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  percentile <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  compactness_factor <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  superpixel <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  frgmt_threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1.414</span> <span class="op">*</span> <span class="fl">2214</span>,</span>
<span>  minPts <span class="op">=</span> <span class="fl">0.005</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object of class <code><a href="SPATA2.html">SPATA2</a></code> or, in case of S4 generics,
objects of classes for which a method has been defined.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Used to absorb deprecated arguments or functions.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character value. The method to use. Either <em>'otsu'</em> or <em>'sps'</em>. See details
for more information. Defaults to <em>'otsu'</em>. (<em>'sps'</em> takes significantly longer, only
recommened if <em>'otsu'</em> does not provide any useful results).</p></dd>


<dt id="arg-img-name">img_name<a class="anchor" aria-label="anchor" href="#arg-img-name"></a></dt>
<dd><p>Character value. The name of the image of interest.
If <code>NULL</code>, the <a href="concept_active.html">active</a> image is chosen by default. Either way, must
be one of <code><a href="getImageNames.html">getImageNames()</a></code>.</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>Numeric value specifying the standard deviation for the Gaussian
blur applied to the grayscale image. Higher values result in more smoothing. <code>0</code> skips
smoothing. Default is <code>0</code>.</p></dd>


<dt id="arg-percentile">percentile<a class="anchor" aria-label="anchor" href="#arg-percentile"></a></dt>
<dd><p>Numeric value between 0 and 100 (inclusive) specifying the percentile
threshold for background color determination. If bigger than 0, it determines
the <strong>top</strong> percentile of colors to identify as background based on the frequency
they appear in the image. This can improve identifying tissue pixels in images
where the edge between tissue and background is continuous rather than sharp
and thus difficult to identify using computational approaches. It follows the
hypothesis that the background consists of many pixels of equal color while
the tissue consists of pixels of heterogenous colors.</p>
<p>Values between 0-100 are valid. Usually values between 0.5-2.5 work well.
Test resuls with <code><a href="plotImageMask.html">plotPixelContent()</a></code>.</p></dd>


<dt id="arg-compactness-factor">compactness_factor<a class="anchor" aria-label="anchor" href="#arg-compactness-factor"></a></dt>
<dd><p>Numeric value controlling the compactness of superpixels.
Given as an argument to <code>$spixel_segmentation()</code> function.</p></dd>


<dt id="arg-superpixel">superpixel<a class="anchor" aria-label="anchor" href="#arg-superpixel"></a></dt>
<dd><p>Numeric value specifying the number of superpixels to compute.
Given as an argument to <code>$spixel_segmentation()</code> function. Increased values can
improve the output but increase runtime.</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>Numeric value specifying the value of <code>eps</code> parameter used in <code><a href="https://rdrr.io/pkg/dbscan/man/dbscan.html" class="external-link">dbscan::dbscan()</a></code>
when applied on the tissue pixels. If the value is less than 1, it is calculated
as a percentage of the width or height of the image, depending on which is larger.
If the value is greater than or equal to 1, it is taken as an absolute value.</p>
<p>Defaults to 1.414<em>2</em>2, twice the distance between two diagonally adjacent pixels in a
uniform pixel space.</p></dd>


<dt id="arg-minpts">minPts<a class="anchor" aria-label="anchor" href="#arg-minpts"></a></dt>
<dd><p>Numeric value specifying the value of <code>minPts</code> parameter used in <code><a href="https://rdrr.io/pkg/dbscan/man/dbscan.html" class="external-link">dbscan::dbscan()</a></code>
when applied on the tissue pixels identified as potential tissue. If the value is less than 1,
it is calculated as a percentage of the width or height of the image, depending on which is larger.
If the value is greater than or equal to 1, it is taken as an absolute value.</p>
<p>Defaults to 0.005, which is 0.5% of the total number of pixels.</p></dd>


<dt id="arg-frgmt-threshold">frgmt_threshold<a class="anchor" aria-label="anchor" href="#arg-frgmt-threshold"></a></dt>
<dd><p>Numeric vector of length 2 specifying the range of the number of pixels
an identified non-background-object in the image must have to be considered a tissue fragment. Objects with a lower number
of pixels than the minimum threshold are considered artifacts, and objects with a higher number
of pixels than the maximum threshold are considered tissue sections. If a threshold value is less than 1,
it is calculated as a percentage of the total number of pixels in the image.
If a threshold value is greater than or equal to 1, it is taken as an absolute value.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, informative messages regarding
the computational progress will be printed.</p>
<p>(Warning messages will always be printed.)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The method for class <code>Image</code> returns a data.frame of the following
variables.</p>
<ul><li><p><em>pixel</em>: character. Pixel index.</p></li>
<li><p><em>width</em>: numeric. Pixel position on horizontal axis of the image.</p></li>
<li><p><em>height</em>: numeric. Pixel position on the vertical axis of the image.</p></li>
<li><p><em>clusterK2</em>: character. Either <em>'background'</em> or <em>'tissue'</em>. (if <em>method = 'sps'</em>)</p></li>
<li><p><em>colTiss#</em> : numeric. Numeric variables that correspond to the color dimensions
of the image mask based on which the clustering of <em>clusterK2</em> was conducted. (if <em>method = 'sps'</em>)</p></li>
<li><p><em>clusterDBSCAN</em>: character. Cluster results of dbscan::dbscan() after removal
of background pixels.</p></li>
<li><p><em>clusterDBSCAN_size</em>:numeric. Size of each dbscan cluster.</p></li>
<li><p><em>content</em>: character. The identified content of each pixel.</p></li>
</ul><p>Methods for S4-classes serving as containers return the input object with the
the results stored in the corresponding slots.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function classifies pixels in an image as tissue, background, or artifacts using two primary methods:
Otsu's method or Superpixel Segmentation (SPS), followed by DBSCAN clustering for refinement.</p>
<ul><li><p><strong>Otsu's Method:</strong> Applies global thresholding to separate tissue from the background
using Otsu's method, which minimizes intra-class variance.
Parameters that affect the output: <code>sigma</code></p></li>
<li><p><strong>Superpixel Segmentation (SPS):</strong> Divides the image into superpixels using the SLIC algorithm.
Superpixels are classified into tissue or background using k-means clustering.
Parameters that affect the output: <code>percentile</code>, <code>compactness_factor</code>, <code>superpixel</code></p></li>
</ul><p>The resulting binary image is refined with DBSCAN clustering to identify contiguous
tissue sections, fragments, and artifacts.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>If <code>img_name</code> specifies multiple images, the function
iterates over all of them. If it is <code>NULL</code> the active image is picked.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Nobuyuki Otsu, "A threshold selection method from gray-level histograms".
IEEE Trans. Sys., Man., Cyber. 9 (1): 62-66. doi:10.1109/TSMC.1979.4310076 (1979)</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>For subsequent image processing: <code>identifyTissueOutline(..., method = 'image')</code>.
For visualization of results: <code><a href="plotImageMask.html">plotImageMask()</a></code>, <code><a href="plotImageMask.html">plotPixelContent()</a></code>.
For extraction of results: <code><a href="getPixelDf.html">getPixelDf()</a></code>.</p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jan Kueckelhaus, Dieter-Henrik Heiland.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

