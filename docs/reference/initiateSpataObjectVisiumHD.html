<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Initiate an object of class SPATA2 from platform VisiumHD — initiateSpataObjectVisiumHD • SPATA2</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Initiate an object of class SPATA2 from platform VisiumHD — initiateSpataObjectVisiumHD"><meta property="og:description" content="This function initiates a SPATA2 object with data generated
using the 10x Genomics VisiumHD platform."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SPATA2</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/installation.html">Installation</a>
</li>
<li>
  <a href="../articles/spata-data.html">SPATAData</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Initiating a SPATA2 object</li>
    <li>
      <a href="../articles/initiation-and-preprocessing-customized.html">Initiation &amp; Preprocessing with individual data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-merfish.html">Initiation &amp; Preprocessing with MERFISH data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium.html">Initiation &amp; Preprocessing with Visium data</a>
    </li>
    <li>
      <a href="../articles/initiation-and-preprocessing-visium-hd.html">Initiation &amp; Preprocessing with VisiumHD data</a>
    </li>
    <li class="dropdown-header">Basic Manipulation of a SPATA2 object</li>
    <li>
      <a href="../articles/adding-data.html">Adding Data to SPATA2 objects</a>
    </li>
    <li>
      <a href="../articles/package-compatibility.html">Platform Compatibility</a>
    </li>
    <li>
      <a href="../articles/molecular-variables.html">Molecular Variables</a>
    </li>
    <li>
      <a href="../articles/image-handling.html">Image Handling</a>
    </li>
    <li>
      <a href="../articles/spatial-segmentation.html">Spatial Segmentation</a>
    </li>
    <li class="dropdown-header">Implemented Algorithms &amp; Concepts</li>
    <li>
      <a href="../articles/cnv.html">Copy Number Variations</a>
    </li>
    <li>
      <a href="../articles/clustering.html">Clustering</a>
    </li>
    <li>
      <a href="../articles/dimensional-reduction.html">Dimensional Reduction</a>
    </li>
    <li>
      <a href="../articles/dea.html">Differential Expression</a>
    </li>
    <li>
      <a href="../articles/gsea.html">Gene Set Enrichment</a>
    </li>
    <li>
      <a href="../articles/spatial-measures.html">Spatial Measures</a>
    </li>
    <li class="dropdown-header">Spatial Gradient Screening</li>
    <li>
      <a href="../articles/creating-spatial-annotations.html">Creating Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/using-spatial-annotations.html">Using Spatial Annotations</a>
    </li>
    <li>
      <a href="../articles/spatial-annotation-screening.html">Spatial Annotation Screening</a>
    </li>
    <li>
      <a href="../articles/creating-spatial-trajectories.html">Creating Spatial Trajectories</a>
    </li>
    <li>
      <a href="../articles/spatial-trajectory-screening.html">Spatial Trajectory Screening</a>
    </li>
    <li class="dropdown-header">Visualization</li>
    <li>
      <a href="../articles/plotting-surface.html">Surface Plotting</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/newslog.html">Newslog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Initiate an object of class <code>SPATA2</code> from platform VisiumHD</h1>

    <div class="hidden name"><code>initiateSpataObjectVisiumHD.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function initiates a <code><a href="SPATA2.html">SPATA2</a></code> object with data generated
using the 10x Genomics <code><a href="VisiumHD.html">VisiumHD</a></code> platform.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">initiateSpataObjectVisiumHD</span><span class="op">(</span></span>
<span>  <span class="va">sample_name</span>,</span>
<span>  <span class="va">directory_visium</span>,</span>
<span>  square_res <span class="op">=</span> <span class="st">"16um"</span>,</span>
<span>  mtr <span class="op">=</span> <span class="st">"filtered"</span>,</span>
<span>  genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  workers <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  batch_size <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  img_active <span class="op">=</span> <span class="st">"lowres"</span>,</span>
<span>  img_ref <span class="op">=</span> <span class="st">"hires"</span>,</span>
<span>  resize_images <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  unload <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-sample-name">sample_name<a class="anchor" aria-label="anchor" href="#arg-sample-name"></a></dt>
<dd><p>Character. The name of the sample.</p></dd>


<dt id="arg-directory-visium">directory_visium<a class="anchor" aria-label="anchor" href="#arg-directory-visium"></a></dt>
<dd><p>Character. The directory containing the Visium output files.</p></dd>


<dt id="arg-square-res">square_res<a class="anchor" aria-label="anchor" href="#arg-square-res"></a></dt>
<dd><p>Character. The square resolution from which to load the data. While <em>c('16um', '8um', '2um')</em>
are the default resolutions, <code><a href="reduceResolutionVisiumHD.html">reduceResolutionVisiumHD()</a></code> is applied if the input
deviates from these three input options. See section <em>Visium HD Resolution</em> for more information.</p></dd>


<dt id="arg-mtr">mtr<a class="anchor" aria-label="anchor" href="#arg-mtr"></a></dt>
<dd><p>Character. Specifies which matrix to use, either "filtered" or "raw". Default is "filtered".</p></dd>


<dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>Character or <code>NULL</code>. If character, specifies beforehand which genes to keep in the count
matrix. If <code>NULL</code>, the default, all genes are kept.</p></dd>


<dt id="arg-workers">workers<a class="anchor" aria-label="anchor" href="#arg-workers"></a></dt>
<dd><p>Integer specifying the number of parallel workers to use for processing. Default is <code>1</code>,
which defaults to no parallel workers. If <code>2</code> or more, the <code>furrr</code> package
is required.</p></dd>


<dt id="arg-batch-size">batch_size<a class="anchor" aria-label="anchor" href="#arg-batch-size"></a></dt>
<dd><p>Integer specifying the number of spatial spots to process in each batch. Default is <code>1000</code>.</p></dd>


<dt id="arg-img-active">img_active<a class="anchor" aria-label="anchor" href="#arg-img-active"></a></dt>
<dd><p>Character. The active image to use, either "lowres" or "hires". Default is "lowres".</p></dd>


<dt id="arg-img-ref">img_ref<a class="anchor" aria-label="anchor" href="#arg-img-ref"></a></dt>
<dd><p>Character. The reference image to use, either "lowres" or "hires". Default is "hires".</p></dd>


<dt id="arg-resize-images">resize_images<a class="anchor" aria-label="anchor" href="#arg-resize-images"></a></dt>
<dd><p>A named list of numeric values between 0-1 used to resize
the respective image as indicated by the slot name. E.g <code>resize_images = list(hires = 0.5)</code>
resizes the hires image to 50% of its original scale.</p></dd>


<dt id="arg-unload">unload<a class="anchor" aria-label="anchor" href="#arg-unload"></a></dt>
<dd><p>Logical value. If <code>TRUE</code>, every image except for the active image
is <a href="unloadImage.html">unloaded.</a></p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, informative messages regarding
the computational progress will be printed.</p>
<p>(Warning messages will always be printed.)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>SPATA2</code> object the VisiumHD platform.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function requires a directory containing the output files from a 10x Genomics VisiumHD experiment
specified with the argument <code>directory_visium</code>. This directory (below denoted as <strong>~</strong>)  must include the following
sub-directories:</p>
<ul><li><p><em>~/binned_outputs</em>: A folder with the following subdirectories.</p><ul><li><p><em>~/binned_outputs/square_002um</em>: The folder containing the data for <code>square_res = '2um'</code>.</p></li>
<li><p><em>~/binned_outputs/square_008um</em>: The folder containing the data for <code>square_res = '8um'</code>.</p></li>
<li><p><em>~/binned_outputs/square_016um</em>: The folder containing the data for <code>square_res = '16um'</code>.</p></li>
</ul></li>
</ul><p>Depending on your input for <code>square_res</code> only the corresponding subfolder is required. This subfolder should
contain the following files and sub-directories:</p>
<ul><li><p><em>~/binned_outputs/&lt;square_res&gt;/filtered_feature_bc_matrix.h5</em> or <em>~/raw_feature_bc_matrix.h5</em>: The HDF5 file containing the filtered or raw feature-barcode matrix, respectively.</p></li>
<li><p><em>~/binned_outputs/&lt;square_res&gt;/spatial/tissue_lowres_image.png</em> or <em>~/spatial/tissue_hires_image.png</em>: The low-resolution or high-resolution tissue image.</p></li>
<li><p><em>~/binned_outputs/&lt;square_res&gt;/spatial/scalefactors_json.json</em>: A JSON file containing the scale factors for the images.</p></li>
<li><p><em>~/binned_outputs/&lt;square_res&gt;/spatial/tissue_position.parquet</em> A .parguet file containing the tissue positions and spatial coordinates.</p></li>
</ul><p>The function will check for these files and process them to create a <code>SPATA2</code> object. It reads the count matrix, loads the spatial data,
and initializes the <code>SPATA2</code> object with the necessary metadata and settings.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>It is crucial to install the package <code>arrow</code> in a way that <code><a href="https://arrow.apache.org/docs/r/reference/read_parquet.html" class="external-link">arrow::read_parquet()</a></code> works. There
are several ways. Installing the package with <code>install.packages('arrow', repos = 'https://apache.r-universe.dev')</code>
worked reliably for us.</p>
    </div>
    <div id="visium-hd-resolution">
    <h2>Visium HD Resolution</h2>


<p>The input for <code>square_res</code> can deviate from the standard resolution options as long as it is an
even number divisible by one of the standard resolutions. In such cases, data from the next possible
lower resolution is read, and <code><a href="reduceResolutionVisiumHD.html">reduceResolutionVisiumHD()</a></code> is applied to aggregate the data.
For example, if <code>square_res = '6um'</code>, data is retrieved from <em>~/binned_outputs/square_002um</em>
and then aggregated accordingly. The same applies if <code>square_res = 10um</code>. If <code>square_res = 24um</code>,
data is read from <em>~/binned_outputs/square_008um</em>; if <code>square_res = 32um</code>, data is read from
<em>~/binned_outputs/square_016um</em>, and so on. If the required folder is missing, data from the
next higher resolution folder is used if possible, else an error is thrown.</p>
<p>Note, that aggregating counts by resolution can take a considerable amount of time. Consider prefiltering
the raw counts using <code>genes</code> and/or increasing the number of cores to use with <code>workers</code>.</p>
    </div>
    <div id="row-and-column-indices">
    <h2>Row and column indices</h2>


<p>Visium spot coordinates come with column and row indices. The functions <code><a href="initiateSpataObjectVisium.html">initiateSpataObjectVisium()</a></code>
and <code>initiateSpataObjectVisiumHD()</code> ensure that <em>col</em> aligns with the direction of the x-coordinates and
that <em>row</em> aligns with the direction of the y-coordinates. If they do not, they are adjusted accordingly.
Hence, these variables should not be used as keys for data merging.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jan Kueckelhaus, Dieter-Henrik Heiland.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

